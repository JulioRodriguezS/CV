</html>
<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>CV Julio Melquiadez Rodríguez Soberano</title>
	<meta name="viewport" content="width=device-width, user-scalable=yes">
	<!--bootstrap-->
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
	<!--font awesome-->
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css">	
	<!--custom styles-->
	<link rel="stylesheet" href="css/main.css">	
</head>
<body class="back-document">
	<div class="container">
		<div class="row">
			<div class="col-sm-3">
				<div class="text-center">
					<img src="img/68890464_460126921500413_2780631162370420158_n.jpg" alt="Perfil CV" width="200" height="200" class="rounded-circle m-2">
				</div>
				<!--About me-->
				<div class="card mt-5">
					<div class="card-header">
						<h6 class="m-0 font-weight-bold text-primary">About Me</h6>
					</div>
					<div class="card-body text-justify small-text">
						<ul class="list-group">
							<li class="list-group-item">
								<p id="goals"></p>
							</li>
							<!--li class="list-group-item">
								<em><b>Recent Personal Deploys</b></em><br>
								<ul class="list-group" id="recentPersonalDeploys"></ul>
							</li-->
							<li class="list-group-item">
								<em><b>Contact to me...</b></em><br>
								<p id="conctactTome"></p>
							</li>
							<li class="list-group-item">
								<em><b>Social Networks</b></em><br>
								<p id="listSocialNetworks"></p>								
							</li>
						</ul>				
					</div>
				</div>	
			</div>
			<!--Resume-->
			<div class="col-sm-9">	
				<div class="m-md-4" id="personalInformationTitle"></div>				
				<hr>

				<!--Skills-->
				<div class="card">
					<div class="card-header">
						<h5 class="m-0 font-weight-bold text-primary">Skills</h5>
					</div>
					<div class="card-body d-flex flex-wrap align-items-baseline" id="listskills"></div>
				</div>

				<!--Work Expertise-->				
				<div class="card">
					<div class="card-header">
						<h5 class="m-0 font-weight-bold text-primary">Work Expertise</h5>
					</div>
					<div class="card-body">
						<ul class="list-group" id="listWorkExpertise"></ul>					
					</div>
				</div>
				
				<!--Degrees-->
				<div class="card">
					<div class="card-header">
							<h5 class="m-0 font-weight-bold text-primary">Degrees</h5>
					</div>
					<div class="card-body">
						<ul class="list-group" id="listDegrees"></ul>
					</div>
				</div>
				
			</div>
		</div>
	</div>
<!--scripts-->
<script src="https://code.jquery.com/jquery-2.2.4.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
<script>
	window.addEventListener("load", () => {
  
  alert('welcome')

  console.log("we are ready...")

  const userId = '5f8df6286300ad2691f37641'


  const $personalInformationTitle = document.getElementById('personalInformationTitle')
  const $conctactTome = document.getElementById('conctactTome')
  fillPersonalIformation('personal', userId, $personalInformationTitle, $conctactTome)
  
  const $listWorkExpertise = document.getElementById('listWorkExpertise')
  fillWorkExpertise('work', userId, $listWorkExpertise)

  const $listskills = document.getElementById('listskills')
  fillSkills('skills', userId, $listskills)

  const $listSocialNetworks = document.getElementById('listSocialNetworks')
  fillSocialNetworks('social', userId, $listSocialNetworks)

  const $goals = document.getElementById('goals')
  fillGoals('goals', userId, $goals)

  const $listDegrees = document.getElementById('listDegrees')
  fillDegrees('degrees', userId, $listDegrees)

  //const $recentPersonalDeploys = document.getElementById('recentPersonalDeploys')
})

async function fillWorkExpertise(action, userId, docElement){ 
  
  let jsonData = await getDataFromURL(partURL(action), userId)

  const monthNames = ["January", "February", "March", "April", "May", "June",
  "July", "August", "September", "October", "November", "December"];
  
  let fillingIt = ''

  for(data of jsonData){
   
    let dates = ( data.initialDate !== "undefined" && data.finalDate !== "undefined" )?`[${ monthNames[parseInt(data.initialDate.split('-')[1])] } - ${ data.initialDate.split('-')[0] }]–[${ monthNames[parseInt(data.finalDate.split('-')[1])] } - ${ data.finalDate.split('-')[0] }]`:''
   
    fillingIt += `
    <li class="list-group-item">
      <em>
        <strong>Company: ${ data.company }</strong></br>
        <strong>Job title: ${ data.title }</strong></br>
        <strong>Description</strong>
        <blockquote>
          ${ data.description }
          <footer>
            <!--month - year-->
            ${dates}
          </footer>
        </blockquote>
      </em>
    </li>
      `
  }  
  docElement.innerHTML = fillingIt
}
 
async function fillPersonalIformation(action, userId, docElement, docElement2){

  let jsonData = await getDataFromURL(partURL(action), userId)

  let fillingIt = `
					<h4 class="name">${ jsonData.title }</h4>
          <h5 class="profession">${ jsonData.name + ' ' + jsonData.lastName }</h5>
    `
  docElement.innerHTML = fillingIt

  fillingIt = `
  <em><b>Cel Phone:</b> ${ jsonData.email } <br>
      <b>Email:</b> <br> ${ jsonData.email }</em>
  `

  docElement2.innerHTML = fillingIt
}

async function fillSkills(action, userId, docElement){

  let jsonData = await getDataFromURL(partURL(action), userId)

  let fillingIt = ''

  for(data of jsonData){
      let levelAndColor = await getLevelAndColorSkill(partURL('skillLevel') + data.skillLevel)
      fillingIt += `
      <div class="skills d-inline mb-2 ml-2">
        <span class="text-left font-weight-bold">${ data.title }</span> 
        <span class="level-skill small-text font-weight-light font-italic text-${levelAndColor.levelColor}">(${levelAndColor.title})</span>
      </div>
  `}
  
  docElement.innerHTML = fillingIt
}

async function fillGoals(action, userId, docElement){
  
  let jsonData = await getDataFromURL(partURL(action), userId)
  
  let fillingIt = ''
  for(data of jsonData)
  fillingIt += `
                <em><b>Profile</b></em> <br>
								<p>${data.description}</p>`
  docElement.innerHTML = fillingIt
}

async function fillSocialNetworks(action, userId, docElement){
  
  let jsonData = await getDataFromURL(partURL(action), userId)
  let fillingIt = ''
  for(data of jsonData)
    fillingIt = `
      <em>${ data.networkName }: <br>						
      <strong><a target="_blank" href="${ data.networkLink }">julio-melquiades-rodriguez-soberano-9097b6145</a></strong></em>
      `
  docElement.innerHTML = fillingIt
}

async function fillDegrees(action, userId, docElement){
  
  let jsonData = await getDataFromURL(partURL(action), userId)
  
  const monthNames = ["January", "February", "March", "April", "May", "June",
  "July", "August", "September", "October", "November", "December"];

  let fillingIt = ''

  for(data of jsonData){
    let dates = ( data.initialDate !== "undefined" && data.finalDate !== "undefined" )?`[${ monthNames[parseInt(data.initialDate.split('-')[1])] } - ${ data.initialDate.split('-')[0] }]–[${ monthNames[parseInt(data.finalDate.split('-')[1])] } - ${ data.finalDate.split('-')[0] }]`:''
    fillingIt = `
    <li class="list-group-item">								
      <em>
        <b>Institution: ${ data.institutionName }</b>
        <blockquote>
        Carreer: ${ data.carrerTitle }
        <footer>
          ${ dates }
        </footer>
        </blockquote>
      </em>								
    </li>
      `
  }
    
  docElement.innerHTML = fillingIt
}

let  getDataFromURL = async (url,userId) => {
  return await $.ajax({
    "dataType": "json",
    "async": true,
    "crossDomain": true,
    "url": url + userId,
    "method": "get",
    "headers": {'Content-Type':'application/json'}
  })
}
let  getLevelAndColorSkill = async (url) => {
  return await $.ajax({
    "dataType": "json",
    "async": true,
    "crossDomain": true,
    "url": url,
    "method": "get",
    "headers": {'Content-Type':'application/json'}
  })
}

function partURL(option){
  let partURL = 'https://peaceful-taiga-91600.herokuapp.com/'
  switch(option){
    case 'skills':
      partURL += 'skills/'
      break
    case 'work':
      partURL += 'work-experience/'
      break
    case 'degrees':
      partURL += 'degrees/'
      break
    case 'hobbies':
      partURL += 'hobbies/'
      break
    case 'courses':
      partURL += 'courses/'
      break
    case 'personal':
      partURL += 'user/'
      break
    case 'social':
      partURL += 'social-network/'
      break
    case 'goals':
      partURL += 'goals/'
      break  
    case 'skillLevel':
      partURL += 'skills/levels/'
      break  
    case 'personalDeploys':
      partURL += 'personal-deploys/'
      break
  }
  return partURL
}

</script>	
</body>
</html>
